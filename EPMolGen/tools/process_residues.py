import os
import glob
from rdkit import Chem
import re
import numpy as np
from rdkit import RDConfig
from rdkit.Chem import ChemicalFeatures

bond_type_map = {'SINGLE':1, 'DOUBLE':2, 'TRIPLE ':3}
def res_graph(res):
    d = {}
    Chem.Kekulize(res)
    for b in res.GetBonds():
        start = b.GetBeginAtom()
        start_name = start.GetProp('_TriposAtomName')
        end = b.GetEndAtom()
        end_name = end.GetProp('_TriposAtomName')
        bond_type = b.GetBondType().__str__()
        if start_name not in d:
            d[start_name] = {}
            d[start_name][end_name] = bond_type_map[bond_type]
        else:
            d[start_name][end_name] = bond_type_map[bond_type]
        if end_name not in d:
            d[end_name] = {}
            d[end_name][start_name] = bond_type_map[bond_type]
        else:
            d[end_name][start_name] = bond_type_map[bond_type]
    return d

def GET_RESIDUES_TOPO(removeHs=True):
    res_graph_dict = {}
    mol2_list = glob.glob('./residues/*.mol2')
    for mol2 in mol2_list:
        res_name = mol2.split('/')[-1].split('.')[0]
        res = Chem.MolFromMol2File(mol2, removeHs=removeHs)
        res_graph_dict[res_name] = res_graph(res)
    return res_graph_dict

def GET_RESIDUES_PROP():
    table = [line.strip().split('\t') for line in open('./residues/res_IMGT_classes.csv').read().split('\n')]
    heads = table[0]
    n_classes = [int(re.search('\d+', i)[0]) for i in table[1]]
    out = {}
    for items in table[2:22]:
        res_name = items[1].upper()
        out[res_name] = {}
        props = items[3:]
        l = []
        for ix_p, p in enumerate(props):
            ix_class = int(re.search('\d+', p)[0]) - 1
            out[res_name][heads[ix_p]] = ix_class
            if p == 'Physicochemical':
                continue   # Physicochemical的属性与Chemical有重合
            else:
                one_hot = np.zeros(n_classes[ix_p], dtype=np.int64)
                one_hot[ix_class] = 1
                l.append(one_hot)
        out[res_name]['One-Hot'] = np.concatenate(l).tolist()
    return out



ATOM_FAMILIES = ['Acceptor', 'Donor', 'Hydrophobe', 'LumpedHydrophobe', 'NegIonizable', 'PosIonizable', 'ZnBinder']
ATOM_FAMILIES_ID = {s: i for i, s in enumerate(ATOM_FAMILIES)}
def GET_RESIDUES_ATOM_PROP():
    res = {v.split('/')[-1].split('.')[0]:v for v in glob.glob('./aa/*.mol2')}
    fdefName = os.path.join(RDConfig.RDDataDir,'BaseFeatures.fdef')
    factory = ChemicalFeatures.BuildFeatureFactory(fdefName)
    aa_atom_prop = {}
    for aa in res:
        rdmol = Chem.MolFromMol2File(res[aa])
        Chem.Kekulize(rdmol)
        feat_mat = np.zeros([rdmol.GetNumAtoms(), len(ATOM_FAMILIES)], dtype=np.int64)
        for feat in factory.GetFeaturesForMol(rdmol):
            feat_mat[feat.GetAtomIds(), ATOM_FAMILIES_ID[feat.GetFamily()]] = 1

        is_aromatic = np.array([a.GetIsAromatic() for a in rdmol.GetAtoms()], dtype=np.int64).reshape(-1,1)
        feat_mat = np.concatenate([is_aromatic, feat_mat], axis=1)
        d = {}
        for ix, a in enumerate(rdmol.GetAtoms()):
            name = a.GetProp('_TriposAtomName')
            if name == 'O':
                d['O_HYD'] = feat_mat[ix].tolist()
            elif name == 'OXT':
                d['O'] = feat_mat[ix].tolist()
            else:
                d[name] = feat_mat[ix].tolist()
        aa_atom_prop[aa] = d
    return aa_atom_prop
    

RESIDUES_TOPO = {
        'SER': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'OG': 1},
            'O': {'C': 2},
            'OG': {'CB': 1}},
        'PRO': {'N': {'CA': 1, 'CD': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'CD': {'N': 1, 'CG': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1}},
        'CYS': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'SG': 1},
            'O': {'C': 2},
            'SG': {'CB': 1}},
        'GLN': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1},
            'CD': {'CG': 1, 'NE2': 1, 'OE1': 2},
            'NE2': {'CD': 1},
            'OE1': {'CD': 2}},
        'TYR': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 2, 'CD2': 1},
            'CD1': {'CG': 2, 'CE1': 1},
            'CD2': {'CG': 1, 'CE2': 2},
            'CE1': {'CD1': 1, 'CZ': 2},
            'CE2': {'CD2': 2, 'CZ': 1},
            'CZ': {'CE1': 2, 'CE2': 1, 'OH': 1},
            'OH': {'CZ': 1}},
        'LEU': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 1, 'CD2': 1},
            'CD1': {'CG': 1},
            'CD2': {'CG': 1}},
        'TRP': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 2, 'CD2': 1},
            'CD1': {'CG': 2, 'NE1': 1},
            'CD2': {'CG': 1, 'CE2': 2, 'CE3': 1},
            'NE1': {'CD1': 1, 'CE2': 1},
            'CE2': {'CD2': 2, 'CZ2': 1, 'NE1': 1},
            'CE3': {'CD2': 1, 'CZ3': 2},
            'CZ2': {'CE2': 1, 'CH2': 2},
            'CZ3': {'CE3': 2, 'CH2': 1},
            'CH2': {'CZ2': 2, 'CZ3': 1}},
        'ASP': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'OD1': 1, 'OD2': 2},
            'OD1': {'CG': 1},
            'OD2': {'CG': 2}},
        'VAL': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG1': 1, 'CG2': 1},
            'O': {'C': 2},
            'CG1': {'CB': 1},
            'CG2': {'CB': 1}},
        'ARG': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1},
            'CD': {'CG': 1, 'NE': 1},
            'NE': {'CD': 1, 'CZ': 1},
            'CZ': {'NE': 1, 'NH1': 2, 'NH2': 1},
            'NH1': {'CZ': 2},
            'NH2': {'CZ': 1}},
        'MET': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'SD': 1},
            'SD': {'CG': 1, 'CE': 1},
            'CE': {'SD': 1}},
        'PHE': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 2, 'CD2': 1},
            'CD1': {'CG': 2, 'CE1': 1},
            'CD2': {'CG': 1, 'CE2': 2},
            'CE1': {'CD1': 1, 'CZ': 2},
            'CE2': {'CD2': 2, 'CZ': 1},
            'CZ': {'CE1': 2, 'CE2': 1}},
        'LYS': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1},
            'CD': {'CG': 1, 'CE': 1},
            'CE': {'CD': 1, 'NZ': 1},
            'NZ': {'CE': 1}},
        'ASN': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'ND2': 1, 'OD1': 2},
            'ND2': {'CG': 1},
            'OD1': {'CG': 2}},
        'GLY': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1},
            'C': {'CA': 1, 'O': 2},
            'O': {'C': 2}},
        'THR': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG2': 1, 'OG1': 1},
            'O': {'C': 2},
            'CG2': {'CB': 1},
            'OG1': {'CB': 1}},
        'ALA': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1},
            'O': {'C': 2}},
        'HIS': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD2': 2, 'ND1': 1},
            'CD2': {'CG': 2, 'NE2': 1},
            'ND1': {'CG': 1, 'CE1': 2},
            'NE2': {'CD2': 1, 'CE1': 1},
            'CE1': {'ND1': 2, 'NE2': 1}},
        'GLU': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1},
            'CD': {'CG': 1, 'OE1': 1, 'OE2': 2},
            'OE1': {'CD': 1},
            'OE2': {'CD': 2}},
        'ILE': {'N': {'CA': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG1': 1, 'CG2': 1},
            'O': {'C': 2},
            'CG1': {'CB': 1, 'CD1': 1},
            'CG2': {'CB': 1},
            'CD1': {'CG1': 1}}
            }

RESIDUES_TOPO_WITH_H = {
    'SER': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'OG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'OG': {'CB': 1, 'HG': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'HG': {'OG': 1}},
    'PRO': {'N': {'CA': 1, 'CD': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'CD': {'N': 1, 'CG': 1, 'HD2': 1, 'HD3': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1, 'HG2': 1, 'HG3': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'HG2': {'CG': 1},
            'HG3': {'CG': 1},
            'HD2': {'CD': 1},
            'HD3': {'CD': 1}},
    'CYS': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'SG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'SG': {'CB': 1, 'HG': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'HG': {'SG': 1}},
    'GLN': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1, 'HG2': 1, 'HG3': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD': {'CG': 1, 'NE2': 1, 'OE1': 2},
            'HG2': {'CG': 1},
            'HG3': {'CG': 1},
            'NE2': {'CD': 1, '1HE2': 1, '2HE2': 1},
            'OE1': {'CD': 2},
            '1HE2': {'NE2': 1},
            '2HE2': {'NE2': 1}},
    'TYR': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 2, 'CD2': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD1': {'CG': 2, 'CE1': 1, 'HD1': 1},
            'CD2': {'CG': 1, 'CE2': 2, 'HD2': 1},
            'CE1': {'CD1': 1, 'CZ': 2, 'HE1': 1},
            'HD1': {'CD1': 1},
            'CE2': {'CD2': 2, 'CZ': 1, 'HE2': 1},
            'HD2': {'CD2': 1},
            'CZ': {'CE1': 2, 'CE2': 1, 'OH': 1},
            'HE1': {'CE1': 1},
            'HE2': {'CE2': 1},
            'OH': {'CZ': 1, 'HH': 1},
            'HH': {'OH': 1}},
    'LEU': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 1, 'CD2': 1, 'HG': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD1': {'CG': 1, '1HD1': 1, '2HD1': 1, '3HD1': 1},
            'CD2': {'CG': 1, '1HD2': 1, '2HD2': 1, '3HD2': 1},
            'HG': {'CG': 1},
            '1HD1': {'CD1': 1},
            '2HD1': {'CD1': 1},
            '3HD1': {'CD1': 1},
            '1HD2': {'CD2': 1},
            '2HD2': {'CD2': 1},
            '3HD2': {'CD2': 1}},
    'TRP': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 2, 'CD2': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD1': {'CG': 2, 'NE1': 1, 'HD1': 1},
            'CD2': {'CG': 1, 'CE2': 2, 'CE3': 1},
            'NE1': {'CD1': 1, 'CE2': 1, 'HE1': 1},
            'HD1': {'CD1': 1},
            'CE2': {'CD2': 2, 'CZ2': 1, 'NE1': 1},
            'CE3': {'CD2': 1, 'CZ3': 2, 'HE3': 1},
            'CZ2': {'CE2': 1, 'CH2': 2, 'HZ2': 1},
            'CZ3': {'CE3': 2, 'CH2': 1, 'HZ3': 1},
            'HE3': {'CE3': 1},
            'HE1': {'NE1': 1},
            'CH2': {'CZ2': 2, 'CZ3': 1, 'HH2': 1},
            'HZ2': {'CZ2': 1},
            'HZ3': {'CZ3': 1},
            'HH2': {'CH2': 1}},
    'ASP': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'OD1': 1, 'OD2': 2},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'OD1': {'CG': 1},
            'OD2': {'CG': 2}},
    'VAL': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG1': 1, 'CG2': 1, 'HB': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG1': {'CB': 1, '1HG1': 1, '2HG1': 1, '3HG1': 1},
            'CG2': {'CB': 1, '1HG2': 1, '2HG2': 1, '3HG2': 1},
            'HB': {'CB': 1},
            '1HG1': {'CG1': 1},
            '2HG1': {'CG1': 1},
            '3HG1': {'CG1': 1},
            '1HG2': {'CG2': 1},
            '2HG2': {'CG2': 1},
            '3HG2': {'CG2': 1}},
    'ARG': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1, 'HG2': 1, 'HG3': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD': {'CG': 1, 'NE': 1, 'HD2': 1, 'HD3': 1},
            'HG2': {'CG': 1},
            'HG3': {'CG': 1},
            'NE': {'CD': 1, 'CZ': 1, 'HE': 1},
            'HD2': {'CD': 1},
            'HD3': {'CD': 1},
            'CZ': {'NE': 1, 'NH1': 2, 'NH2': 1},
            'HE': {'NE': 1},
            'NH1': {'CZ': 2, '1HH1': 1, '2HH1': 1},
            'NH2': {'CZ': 1, '1HH2': 1, '2HH2': 1},
            '1HH1': {'NH1': 1},
            '2HH1': {'NH1': 1},
            '1HH2': {'NH2': 1},
            '2HH2': {'NH2': 1}},
    'MET': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'SD': 1, 'HG2': 1, 'HG3': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'SD': {'CG': 1, 'CE': 1},
            'HG2': {'CG': 1},
            'HG3': {'CG': 1},
            'CE': {'SD': 1, 'HE1': 1, 'HE2': 1, 'HE3': 1},
            'HE1': {'CE': 1},
            'HE2': {'CE': 1},
            'HE3': {'CE': 1}},
    'PHE': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD1': 2, 'CD2': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD1': {'CG': 2, 'CE1': 1, 'HD1': 1},
            'CD2': {'CG': 1, 'CE2': 2, 'HD2': 1},
            'CE1': {'CD1': 1, 'CZ': 2, 'HE1': 1},
            'HD1': {'CD1': 1},
            'CE2': {'CD2': 2, 'CZ': 1, 'HE2': 1},
            'HD2': {'CD2': 1},
            'CZ': {'CE1': 2, 'CE2': 1, 'HZ': 1},
            'HE1': {'CE1': 1},
            'HE2': {'CE2': 1},
            'HZ': {'CZ': 1}},
    'LYS': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1, 'HG2': 1, 'HG3': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD': {'CG': 1, 'CE': 1, 'HD2': 1, 'HD3': 1},
            'HG2': {'CG': 1},
            'HG3': {'CG': 1},
            'CE': {'CD': 1, 'NZ': 1, 'HE2': 1, 'HE3': 1},
            'HD2': {'CD': 1},
            'HD3': {'CD': 1},
            'NZ': {'CE': 1, 'HZ1': 1, 'HZ2': 1, 'HZ3': 1},
            'HE2': {'CE': 1},
            'HE3': {'CE': 1},
            'HZ1': {'NZ': 1},
            'HZ2': {'NZ': 1},
            'HZ3': {'NZ': 1}},
    'ASN': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'ND2': 1, 'OD1': 2},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'ND2': {'CG': 1, '1HD2': 1, '2HD2': 1},
            'OD1': {'CG': 2},
            '1HD2': {'ND2': 1},
            '2HD2': {'ND2': 1}},
    'GLY': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'HA2': 1, 'HA3': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'HA2': {'CA': 1},
            'HA3': {'CA': 1},
            'O': {'C': 2}},
            'THR': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG2': 1, 'OG1': 1, 'HB': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG2': {'CB': 1, '1HG2': 1, '2HG2': 1, '3HG2': 1},
            'OG1': {'CB': 1, 'HG1': 1},
            'HB': {'CB': 1},
            '1HG2': {'CG2': 1},
            '2HG2': {'CG2': 1},
            '3HG2': {'CG2': 1},
            'HG1': {'OG1': 1}},
    'ALA': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'HB1': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'HB1': {'CB': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1}},
    'HIS': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD2': 2, 'ND1': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD2': {'CG': 2, 'NE2': 1, 'HD2': 1},
            'ND1': {'CG': 1, 'CE1': 2},
            'NE2': {'CD2': 1, 'CE1': 1, 'HE2': 1},
            'HD2': {'CD2': 1},
            'CE1': {'ND1': 2, 'NE2': 1, 'HE1': 1},
            'HE1': {'CE1': 1},
            'HE2': {'NE2': 1}},
    'GLU': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG': 1, 'HB2': 1, 'HB3': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG': {'CB': 1, 'CD': 1, 'HG2': 1, 'HG3': 1},
            'HB2': {'CB': 1},
            'HB3': {'CB': 1},
            'CD': {'CG': 1, 'OE1': 1, 'OE2': 2},
            'HG2': {'CG': 1},
            'HG3': {'CG': 1},
            'OE1': {'CD': 1},
            'OE2': {'CD': 2}},
    'ILE': {'N': {'CA': 1, 'H': 1},
            'CA': {'N': 1, 'C': 1, 'CB': 1, 'HA': 1},
            'H': {'N': 1},
            'C': {'CA': 1, 'O': 2},
            'CB': {'CA': 1, 'CG1': 1, 'CG2': 1, 'HB': 1},
            'HA': {'CA': 1},
            'O': {'C': 2},
            'CG1': {'CB': 1, 'CD1': 1, '2HG1': 1, '3HG1': 1},
            'CG2': {'CB': 1, '1HG2': 1, '2HG2': 1, '3HG2': 1},
            'HB': {'CB': 1},
            'CD1': {'CG1': 1, '1HD1': 1, '2HD1': 1, '3HD1': 1},
            '2HG1': {'CG1': 1},
            '3HG1': {'CG1': 1},
            '1HG2': {'CG2': 1},
            '2HG2': {'CG2': 1},
            '3HG2': {'CG2': 1},
            '1HD1': {'CD1': 1},
            '2HD1': {'CD1': 1},
            '3HD1': {'CD1': 1}}
            }

RESIDUES_PROP = {
    'ALA': {'Hydropathy': 0,
            'Volume': 0,
            'Chemical': 0,
            'Physicochemical': 0,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 3,
            'cls':[0, 0, 0, 0, 2, 1, 3],
            'One-Hot':[1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1]},
    'ARG': {'Hydropathy': 2,
            'Volume': 3,
            'Chemical': 4,
            'Physicochemical': 4,
            'Charge': 0,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 0,
            'cls':[2, 3, 4, 4, 0, 0, 0],
            'One-Hot':[0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0]},
    'ASN': {'Hydropathy': 2,
            'Volume': 1,
            'Chemical': 6,
            'Physicochemical': 1,
            'Charge': 2,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 2,
            'cls':[2, 1, 6, 1, 2, 0, 2],
            'One-Hot':[0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0]},
    'ASP': {'Hydropathy': 2,
            'Volume': 1,
            'Chemical': 5,
            'Physicochemical': 5,
            'Charge': 1,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 1,
            'cls':[2, 1, 5, 5, 1, 0, 1],
            'One-Hot':[0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0]},
    'CYS': {'Hydropathy': 0,
            'Volume': 1,
            'Chemical': 2,
            'Physicochemical': 2,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 3,
            'cls':[0, 1, 2, 2, 2, 1, 3],
            'One-Hot':[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1]},
    'GLN': {'Hydropathy': 2,
            'Volume': 2,
            'Chemical': 6,
            'Physicochemical': 1,
            'Charge': 2,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 2,
            'cls':[2, 2, 6, 1, 2, 0, 2],
            'One-Hot':[0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0]},
    'GLU': {'Hydropathy': 2,
            'Volume': 2,
            'Chemical': 5,
            'Physicochemical': 5,
            'Charge': 1,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 1,
            'cls':[2, 2, 5, 5, 1, 0, 1],
            'One-Hot':[0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0]},
    'GLY': {'Hydropathy': 1,
            'Volume': 0,
            'Chemical': 0,
            'Physicochemical': 10,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 3,
            'cls':[1, 0, 0, 10, 2, 1, 3],
            'One-Hot':[0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1]},
    'HIS': {'Hydropathy': 1,
            'Volume': 2,
            'Chemical': 4,
            'Physicochemical': 4,
            'Charge': 0,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 2,
            'cls':[1, 2, 4, 4, 0, 0, 2],
            'One-Hot':[0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0]},
    'ILE': {'Hydropathy': 0,
            'Volume': 3,
            'Chemical': 0,
            'Physicochemical': 0,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 3,
            'cls':[0, 3, 0, 0, 2, 1, 3],
            'One-Hot':[1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1]},
    'LEU': {'Hydropathy': 0,
            'Volume': 3,
            'Chemical': 0,
            'Physicochemical': 0,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 3,
            'cls':[0, 3, 0, 0, 2, 1, 3],
            'One-Hot':[1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1]},
    'LYS': {'Hydropathy': 2,
            'Volume': 3,
            'Chemical': 4,
            'Physicochemical': 4,
            'Charge': 0,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 0,
            'cls':[2, 3, 4, 4, 0, 0, 0],
            'One-Hot':[0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0]},
    'MET': {'Hydropathy': 0,
            'Volume': 3,
            'Chemical': 2,
            'Physicochemical': 2,
            'Charge': 2,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 3,
            'cls':[0, 3, 2, 2, 2, 0, 3],
            'One-Hot':[1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1]},
    'PHE': {'Hydropathy': 0,
            'Volume': 4,
            'Chemical': 1,
            'Physicochemical': 6,
            'Charge': 2,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 3,
            'cls':[0, 4, 1, 6, 2, 0, 3],
            'One-Hot':[1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1]},
    'PRO': {'Hydropathy': 1,
            'Volume': 1,
            'Chemical': 0,
            'Physicochemical': 9,
            'Charge': 2,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 3,
            'cls':[1, 1, 0, 9, 2, 0, 3],
            'One-Hot':[0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1]},
    'SER': {'Hydropathy': 1,
            'Volume': 0,
            'Chemical': 3,
            'Physicochemical': 3,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 2,
            'cls':[1, 0, 3, 3, 2, 1, 2],
            'One-Hot':[0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0]},
    'THR': {'Hydropathy': 1,
            'Volume': 1,
            'Chemical': 3,
            'Physicochemical': 3,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 2,
            'cls':[1, 1, 3, 3, 2, 1, 2],
            'One-Hot':[0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0]},
    'TRP': {'Hydropathy': 0,
            'Volume': 4,
            'Chemical': 1,
            'Physicochemical': 7,
            'Charge': 2,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 0,
            'cls':[0, 4, 1, 7, 2, 0, 0],
            'One-Hot':[1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0]},
    'TYR': {'Hydropathy': 1,
            'Volume': 4,
            'Chemical': 1,
            'Physicochemical': 8,
            'Charge': 2,
            'Polarity': 1,
            'Hydrogen donor or acceptor': 2,
            'cls':[1, 4, 1, 8, 2, 1, 2],
            'One-Hot':[0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0]},
    'VAL': {'Hydropathy': 0,
            'Volume': 2,
            'Chemical': 0,
            'Physicochemical': 0,
            'Charge': 2,
            'Polarity': 0,
            'Hydrogen donor or acceptor': 3,
            'cls':[0, 2, 0, 0, 2, 0, 3],
            'One-Hot':[1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1]}
    }

RESIDUES_ATOM_PROP = {
    'ALA': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB3': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'ARG': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'NE': [0, 0, 0, 0, 0, 0, 1, 0], 
            'NH1': [0, 0, 1, 0, 0, 0, 1, 0], 
            'NH2': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CG': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CD': [0, 0, 0, 0, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CZ': [0, 0, 0, 0, 0, 0, 1, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HH11': [0, 0, 0, 0, 0, 0, 0, 0],
            'HH12': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HH21': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HH22': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'ASN': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'OD1': [0, 1, 0, 0, 0, 0, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'ND2': [0, 0, 1, 0, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CG': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD21': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD22': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'ASP': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'OD1': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'OD2': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CG': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'CYS': {'SG': [0, 0, 1, 0, 0, 0, 0, 0], 
            'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'GLN': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'OE1': [0, 1, 0, 0, 0, 0, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'NE2': [0, 0, 1, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CD': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE21': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE22': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'GLU': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'OE1': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'OE2': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CD': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE1': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'GLY': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HA1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'HIS': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'ND1': [1, 0, 0, 0, 0, 0, 1, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'NE2': [1, 0, 0, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG': [1, 0, 0, 0, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CD2': [1, 0, 0, 0, 0, 0, 0, 0], 
            'CE1': [1, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'ILE': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG1': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CG2': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CD1': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HB': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG11': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG12': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG21': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG22': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG23': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD11': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD12': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD13': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'LEU': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CG': [0, 0, 0, 1, 1, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CD1': [0, 0, 0, 1, 1, 0, 0, 0], 
            'CD2': [0, 0, 0, 1, 1, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HG': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD11': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD12': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD13': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD21': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD22': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD23': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'LYS': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'NZ': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CG': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CD': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CE': [0, 0, 0, 0, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HG1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HZ1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HZ2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'MET': {'SD': [0, 0, 0, 0, 0, 0, 0, 0], 
            'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CE': [0, 0, 0, 1, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE3': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'PHE': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CD1': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CD2': [1, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CE1': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CE2': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CZ': [1, 0, 0, 1, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HZ': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'PRO': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CG': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CD': [0, 0, 0, 0, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'SER': {'OG': [0, 1, 1, 0, 0, 0, 0, 0], 
            'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 0, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'THR': {'OG1': [0, 1, 1, 0, 0, 0, 0, 0], 
            'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG2': [0, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG21': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG22': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG23': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'TRP': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'NE1': [1, 0, 1, 0, 0, 0, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CG': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CD2': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CE2': [1, 0, 0, 0, 0, 0, 0, 0], 
            'CD1': [1, 0, 0, 0, 0, 0, 0, 0], 
            'CE3': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CZ2': [1, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CZ3': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CH2': [1, 0, 0, 1, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE3': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HZ2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HZ3': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HH2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'TYR': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'OH': [0, 1, 1, 0, 0, 0, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 1, 0, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CD1': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CD2': [1, 0, 0, 1, 0, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'CE1': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CE2': [1, 0, 0, 1, 0, 0, 0, 0], 
            'CZ': [1, 0, 0, 0, 0, 0, 0, 0], 
            'HB1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HB2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HD2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HE2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HH': [0, 0, 0, 0, 0, 0, 0, 0]}, 
    'VAL': {'OXT': [0, 1, 1, 0, 0, 1, 0, 0], 
            'O': [0, 1, 0, 0, 0, 1, 0, 0], 
            'N': [0, 0, 1, 0, 0, 0, 1, 0], 
            'CB': [0, 0, 0, 1, 1, 0, 0, 0], 
            'CA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'CG1': [0, 0, 0, 1, 1, 0, 0, 0], 
            'CG2': [0, 0, 0, 1, 1, 0, 0, 0], 
            'C': [0, 0, 0, 0, 0, 1, 0, 0], 
            'HB': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HA': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG11': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG12': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG13': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG21': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG22': [0, 0, 0, 0, 0, 0, 0, 0], 
            'HG23': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H1': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H2': [0, 0, 0, 0, 0, 0, 0, 0], 
            'H': [0, 0, 0, 0, 0, 0, 0, 0]}
            }